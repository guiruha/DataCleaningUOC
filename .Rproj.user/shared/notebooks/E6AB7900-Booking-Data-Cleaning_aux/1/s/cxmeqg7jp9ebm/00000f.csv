"0","proc_flights <- flights %>% "
"0","        # Filtramos para quedarnos solo con los aeropuertos de interés"
"0","        # Código OACI/ICAO: Barcelona --> ES_LEBL; Valencia --> ES_LEVC; Madrid: ES_LEMD"
"0","        filter(rep_airp %in% c(""ES_LEBL"", ""ES_LEVC"", ""ES_LEMD"")) %>% "
"0","        # Filtramos para quedarnos solo con los datos de carga de pasajeros"
"0","        filter(tra_meas == ""PAS_CRD"") %>%"
"0","        # Nos interesa solo los datos mensuales, así que filtramos por ellos"
"0","        filter(freq == ""M"") %>%"
"0","        separate(TIME_PERIOD, c(""YEAR"", ""MONTH""), sep = ""-"") %>%"
"0","        # Nos quedamos solo con los últimos 5 años y los meses de Marzo, Junio y Diciembre"
"0","        filter(YEAR %in% c(""2022"", ""2021"", ""2020"", ""2019"", ""2018"") & MONTH %in% c(""03"", ""06"", ""12"")) %>%"
"0","        # No nos interesa los datos por aerolínea, solo los generales"
"0","        filter(airline == ""TOTAL"") %>%"
"0","        # Modificamos la columna de MONTH para tener los nombres del mes y cambiamos el código del aeropuerto por el nombre de la ciudad"
"0","        mutate(month_name = ifelse(MONTH == ""03"", ""March"", ifelse(MONTH == ""06"", ""June"", ""December"")),"
"0","               city_airp = ifelse(rep_airp == ""ES_LEBL"", ""Barcelona"", ifelse(rep_airp == ""ES_LEVC"", ""Valencia"", ""Madrid""))) %>%"
"0","        # Agrupamos por ciudad y mes y calculamos la media de vuelos."
"0","        group_by(rep_airp, month_name) %>%"
"0","        mutate(mean_fligths = mean(OBS_VALUE)) %>%"
"0","        ungroup() %>%"
"0","        select(c(city_airp, month_name, mean_fligths))"
"0",""
"0","# Nos quedamos con los registros únicos"
"0","final_flights <- unique(proc_flights)"
"0",""
"0","# Hacemos un merge con bookings"
"0","booking <- booking %>%"
"0","  merge(final_flights, by.x = c(""city"", ""month_in""), by.y = c(""city_airp"", ""month_name""))"
